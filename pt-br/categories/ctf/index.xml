<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>CTF on Moreno&#39;s Blog</title>
        <link>https://kauamoreno.dev/pt-br/categories/ctf/</link>
        <description>Recent content in CTF on Moreno&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>pt-br</language>
        <copyright>Kau√£ Moreno</copyright>
        <lastBuildDate>Fri, 21 Nov 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://kauamoreno.dev/pt-br/categories/ctf/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>O retorno do Bislacha</title>
        <link>https://kauamoreno.dev/pt-br/p/o-retorno-do-bislacha/</link>
        <pubDate>Fri, 21 Nov 2025 00:00:00 +0000</pubDate>
        
        <guid>https://kauamoreno.dev/pt-br/p/o-retorno-do-bislacha/</guid>
        <description>&lt;img src="https://kauamoreno.dev/p/the-return-of-bislacha/cover.jpg" alt="Featured image of post O retorno do Bislacha" /&gt;&lt;h2 id=&#34;objetivo&#34;&gt;Objetivo
&lt;/h2&gt;&lt;p&gt;O objetivo do desafio foi realizar reconhecimento, analisar arquivos (esteganografia/strings), decodificar credenciais e explorar um controle de acesso fraco para escalonamento de privil√©gios.&lt;/p&gt;
&lt;h2 id=&#34;solu√ß√£o&#34;&gt;Solu√ß√£o
&lt;/h2&gt;&lt;h3 id=&#34;fazendo-o-reconhecimento&#34;&gt;Fazendo o reconhecimento
&lt;/h3&gt;&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/reconhecimento.png&#34;
	width=&#34;1920&#34;
	height=&#34;446&#34;
	srcset=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/reconhecimento_hu_3bd5939bc644c5aa.png 480w, https://kauamoreno.dev/p/the-return-of-bislacha/img/reconhecimento_hu_b874b8c3ca9067cd.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Reconhecimento&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;430&#34;
		data-flex-basis=&#34;1033px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;O site, √† primeira vista, cont√©m apenas duas abas: &lt;strong&gt;Home&lt;/strong&gt; e &lt;strong&gt;Login&lt;/strong&gt;. A aba Home redireciona para a aba Login. Inspecionei o HTML e o console do navegador e nada de anormal apareceu.
Para testar o funcionamento do sistema de login, iniciei com um teste de SQL Injection simples: &lt;code&gt;&#39; OR 1=1 --&lt;/code&gt;. O sistema retornou &lt;code&gt;Login e/ou senha incorretos&lt;/code&gt;, sugerindo que n√£o havia uma vulnerabilidade SQL trivial na rota de login.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/request.png&#34;
	width=&#34;277&#34;
	height=&#34;169&#34;
	srcset=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/request_hu_86599f2bc399c1d5.png 480w, https://kauamoreno.dev/p/the-return-of-bislacha/img/request_hu_3d274f13e6757a38.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Request&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;163&#34;
		data-flex-basis=&#34;393px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Ao examinar melhor a p√°gina, reparei em um pequeno texto no logo:&lt;/p&gt;
&lt;center&gt;
    &lt;img src=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/logo.png&#34; width=&#34;300&#34;&gt;
    &lt;img src=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/texto-logo.png&#34; width=&#34;150&#34;&gt;
&lt;/center&gt;
&lt;p&gt;Esse texto apontava para um diret√≥rio/arquivo do site que carregava uma imagem.&lt;/p&gt;
&lt;h3 id=&#34;analisando-a-imagem&#34;&gt;Analisando a imagem
&lt;/h3&gt;&lt;p&gt;Baixei a imagem e procurei por strings leg√≠veis (com &lt;code&gt;strings&lt;/code&gt;). A imagem aparentava ser um fundo preto, mas nas strings encontrei dados que lembravam credenciais codificadas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/hexedit-login.png&#34;
	width=&#34;699&#34;
	height=&#34;227&#34;
	srcset=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/hexedit-login_hu_b36397e608a9c685.png 480w, https://kauamoreno.dev/p/the-return-of-bislacha/img/hexedit-login_hu_92eb3e2f9187647a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Hexedit Login&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;307&#34;
		data-flex-basis=&#34;739px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Voltando √† pagina de login, colocando as credencias encontradas e clicando em login, a mensagem &lt;code&gt;Login e/ou senha incorretos&lt;/code&gt; √© retornada.
Analisando um pouco melhor, percebe-se que o login e a senha foram codificados em &lt;strong&gt;Base64&lt;/strong&gt; um forte indicativo √© o final &lt;code&gt;=&lt;/code&gt; caracter√≠stico
Decodificando ambos com uso do CyberChef chegamos em:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Login:&lt;/strong&gt; bislacha&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Senha:&lt;/strong&gt; bislachamuitofoda12345&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Com as credenciais corretas, agora o login foi um sucesso.&lt;/p&gt;
&lt;h3 id=&#34;acesso&#34;&gt;Acesso
&lt;/h3&gt;&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/logado.png&#34;
	width=&#34;872&#34;
	height=&#34;389&#34;
	srcset=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/logado_hu_1e2a8f11e2e22e46.png 480w, https://kauamoreno.dev/p/the-return-of-bislacha/img/logado_hu_55277c56285b6463.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Logado&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;224&#34;
		data-flex-basis=&#34;537px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Ap√≥s entrar, uma nova aba chamada &lt;strong&gt;Membros&lt;/strong&gt; foi disponibilizada. Nela vi uma listagem de membros atuais e ex-membros; foquei no usu√°rio autenticado (Bislacha).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/bislacha.png&#34;
	width=&#34;424&#34;
	height=&#34;103&#34;
	srcset=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/bislacha_hu_c009bb17cd1c590f.png 480w, https://kauamoreno.dev/p/the-return-of-bislacha/img/bislacha_hu_56f88a00df454c3e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Bislacha&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;411&#34;
		data-flex-basis=&#34;987px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;No lugar de seu apelido podemos ver que se trata de uma base64 novamente, e decodificando temos: &lt;code&gt;panel.php&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;panelphp&#34;&gt;Panel.php
&lt;/h3&gt;&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/panel.png&#34;
	width=&#34;890&#34;
	height=&#34;399&#34;
	srcset=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/panel_hu_eb4ea0aefe992d0e.png 480w, https://kauamoreno.dev/p/the-return-of-bislacha/img/panel_hu_d0c10f4be7272ac1.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Panel&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;223&#34;
		data-flex-basis=&#34;535px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Ao acessar &lt;code&gt;/panel.php&lt;/code&gt; fui informado de que a conta estava logada, mas n√£o era admin. Isso indica que existe um painel administrativo protegido por controle de acesso, ou seja, havia potencial para escalonamento de privil√©gio.&lt;/p&gt;
&lt;h3 id=&#34;escalonamento-de-privil√©gio&#34;&gt;Escalonamento de privil√©gio
&lt;/h3&gt;&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/cookies.png&#34;
	width=&#34;517&#34;
	height=&#34;173&#34;
	srcset=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/cookies_hu_4265a50050d32d3f.png 480w, https://kauamoreno.dev/p/the-return-of-bislacha/img/cookies_hu_de9b4752a804db96.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Cookies&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;298&#34;
		data-flex-basis=&#34;717px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Inspecionando os Cookies armazenados podemos achar os campos &lt;code&gt;login&lt;/code&gt; e &lt;code&gt;user&lt;/code&gt; com seus respectivos valores, e percebemos se tratar novamente de uma base64, decodificando ambos, ficamos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;login:&lt;/strong&gt; bislacha&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;user:&lt;/strong&gt; member&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ou seja, o sistema armazena os tipos de usuario em base64, como  precisamos escalar para &lt;code&gt;admin&lt;/code&gt;, eu troco o atual user por &lt;code&gt;YWRtaW4=&lt;/code&gt;, sua vers√£o codificada e recarrego a pagina.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/resolucao.png&#34;
	width=&#34;940&#34;
	height=&#34;386&#34;
	srcset=&#34;https://kauamoreno.dev/p/the-return-of-bislacha/img/resolucao_hu_ee17fee683cb0fdb.png 480w, https://kauamoreno.dev/p/the-return-of-bislacha/img/resolucao_hu_9ee23f3ff26343ec.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Resolu√ß√£o&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;243&#34;
		data-flex-basis=&#34;584px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Ap√≥s recarregar a p√°gina, a interface mudou para a vers√£o de administrador e a flag do desafio foi exibida&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Patch</title>
        <link>https://kauamoreno.dev/pt-br/p/patch/</link>
        <pubDate>Thu, 20 Nov 2025 00:00:00 +0000</pubDate>
        
        <guid>https://kauamoreno.dev/pt-br/p/patch/</guid>
        <description>&lt;img src="https://kauamoreno.dev/p/patch/banner.jpeg" alt="Featured image of post Patch" /&gt;&lt;h2 id=&#34;enunciado&#34;&gt;Enunciado
&lt;/h2&gt;&lt;p&gt;Voc√™ sabe como faz um patch?&lt;/p&gt;
&lt;p&gt;üëâ &lt;a class=&#34;link&#34; href=&#34;https://kauamoreno.dev/p/patch/files/patch&#34; &gt;Clique para baixar o arquivo patch&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;objetivo&#34;&gt;Objetivo
&lt;/h2&gt;&lt;p&gt;O objetivo deste desafio era localizar e analisar as fun√ß√µes do arquivo &lt;code&gt;patch&lt;/code&gt; para identificar a rotina respons√°vel pela gera√ß√£o da flag.&lt;/p&gt;
&lt;h2 id=&#34;solu√ß√£o&#34;&gt;Solu√ß√£o
&lt;/h2&gt;&lt;h3 id=&#34;metadados&#34;&gt;Metadados
&lt;/h3&gt;&lt;p&gt;Verifiquei os metadados do bin√°rio em busca de dicas ou incongru√™ncias; n√£o encontrei nada relevante.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/patch/img/metadados.png&#34;
	width=&#34;822&#34;
	height=&#34;434&#34;
	srcset=&#34;https://kauamoreno.dev/p/patch/img/metadados_hu_484e9cf321de87ee.png 480w, https://kauamoreno.dev/p/patch/img/metadados_hu_261d30b63137a2e7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Metadados&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;189&#34;
		data-flex-basis=&#34;454px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;strings-leg√≠veis&#34;&gt;Strings leg√≠veis
&lt;/h3&gt;&lt;p&gt;Listei as strings leg√≠veis do arquivo para procurar pistas. Encontrei uma frase e duas palavras que n√£o apontavam diretamente para a flag. A √∫nica associa√ß√£o √≥bvia foi entre ‚Äúderrota‚Äù e a string ‚ÄúBoa sorte da pr√≥xima‚Äù.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/patch/img/string-input.png&#34;
	width=&#34;192&#34;
	height=&#34;31&#34;
	srcset=&#34;https://kauamoreno.dev/p/patch/img/string-input_hu_a79e4d57d5903966.png 480w, https://kauamoreno.dev/p/patch/img/string-input_hu_b212e5d4138dae6d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Strings Input&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;619&#34;
		data-flex-basis=&#34;1486px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/patch/img/string-output.png&#34;
	width=&#34;368&#34;
	height=&#34;436&#34;
	srcset=&#34;https://kauamoreno.dev/p/patch/img/string-output_hu_72f3d2a224b36921.png 480w, https://kauamoreno.dev/p/patch/img/string-output_hu_8f64b3b2bf2e03cb.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Strings Output&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;84&#34;
		data-flex-basis=&#34;202px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;verificando-as-fun√ß√µes-do-programa&#34;&gt;Verificando as fun√ß√µes do programa
&lt;/h3&gt;&lt;p&gt;Ao revisar as fun√ß√µes do programa, ficou claro que as palavras encontradas nas strings faziam parte do fluxo do c√≥digo. Isso sugeriu que as fun√ß√µes &lt;code&gt;derrota()&lt;/code&gt; e &lt;code&gt;vitoria()&lt;/code&gt; seriam relevantes, provavelmente &lt;code&gt;vitoria()&lt;/code&gt; retornaria a flag.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/patch/img/funcoes-input.png&#34;
	width=&#34;218&#34;
	height=&#34;32&#34;
	srcset=&#34;https://kauamoreno.dev/p/patch/img/funcoes-input_hu_a1fd65fafa0e2d9.png 480w, https://kauamoreno.dev/p/patch/img/funcoes-input_hu_4190cd3ffd2ea512.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Fun√ß√µes Input&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;681&#34;
		data-flex-basis=&#34;1635px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/patch/img/funcoes-output.png&#34;
	width=&#34;396&#34;
	height=&#34;327&#34;
	srcset=&#34;https://kauamoreno.dev/p/patch/img/funcoes-output_hu_c7c54071bc0cafcd.png 480w, https://kauamoreno.dev/p/patch/img/funcoes-output_hu_f5c077c17782b788.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Fun√ß√µes Output&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;121&#34;
		data-flex-basis=&#34;290px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;executando-as-fun√ß√µes&#34;&gt;Executando as fun√ß√µes
&lt;/h3&gt;&lt;p&gt;Inicialmente tentei executar as fun√ß√µes em modo de debug, mas recebi um erro por falta de permiss√£o. Ap√≥s ajustar as permiss√µes/ambiente (permitindo o debug/execu√ß√£o), consegui chamar as fun√ß√µes.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/patch/img/executa-erro.png&#34;
	width=&#34;913&#34;
	height=&#34;379&#34;
	srcset=&#34;https://kauamoreno.dev/p/patch/img/executa-erro_hu_f3aa8ba1eef71d8f.png 480w, https://kauamoreno.dev/p/patch/img/executa-erro_hu_8833db9c69b9b56c.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Erro Execu√ß√£o&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;240&#34;
		data-flex-basis=&#34;578px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/patch/img/ativa-permissao.png&#34;
	width=&#34;217&#34;
	height=&#34;32&#34;
	srcset=&#34;https://kauamoreno.dev/p/patch/img/ativa-permissao_hu_d37033ce426856ce.png 480w, https://kauamoreno.dev/p/patch/img/ativa-permissao_hu_923d67408fdbca08.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Ativa Permiss√£o&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;678&#34;
		data-flex-basis=&#34;1627px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Tive que lidar com o tipo de retorno desconhecido das fun√ß√µes; para contornar isso, tratei o retorno como &lt;code&gt;void&lt;/code&gt; temporariamente para for√ßar a execu√ß√£o. Ao executar:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;derrota()&lt;/code&gt; imprimiu a mesma frase encontrada nas strings leg√≠veis;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vitoria()&lt;/code&gt; retornou a flag buscada.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/patch/img/executa-sucesso.png&#34;
	width=&#34;924&#34;
	height=&#34;215&#34;
	srcset=&#34;https://kauamoreno.dev/p/patch/img/executa-sucesso_hu_66d199d085cd1945.png 480w, https://kauamoreno.dev/p/patch/img/executa-sucesso_hu_38a57a4893eded94.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Execu√ß√£o Sucesso&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;429&#34;
		data-flex-basis=&#34;1031px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;interpreta√ß√£o--explica√ß√£o&#34;&gt;Interpreta√ß√£o / explica√ß√£o
&lt;/h3&gt;&lt;p&gt;A fun√ß√£o &lt;code&gt;derrota()&lt;/code&gt; apenas devolve a string armazenada &amp;ldquo;crua&amp;rdquo; no bin√°rio, por isso j√° aparecia listada nas strings leg√≠veis. J√° a fun√ß√£o &lt;code&gt;vitoria()&lt;/code&gt; aparentemente realiza um processo de decodifica√ß√£o sobre um dado previamente armazenado; ao executar essa rotina, a flag √© revelada.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://kauamoreno.dev/p/patch/img/analise-funcao.png&#34;
	width=&#34;1086&#34;
	height=&#34;813&#34;
	srcset=&#34;https://kauamoreno.dev/p/patch/img/analise-funcao_hu_9fcee4aa33a83cc2.png 480w, https://kauamoreno.dev/p/patch/img/analise-funcao_hu_546f88636662913d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;An√°lise da Fun√ß√£o&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;133&#34;
		data-flex-basis=&#34;320px&#34;
	
&gt;&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
